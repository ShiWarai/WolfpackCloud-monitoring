# API Reference

Интерактивная документация API автоматически генерируется FastAPI. Доступна по адресу API (порт `API_PORT` из `.env`):

| Формат | Путь | Описание |
|--------|------|----------|
| Swagger UI | `/docs` | Интерактивная документация с возможностью тестирования |
| ReDoc | `/redoc` | Читаемая документация |
| OpenAPI JSON | `/openapi.json` | Схема для генерации клиентов |

## Аутентификация

### Пользователи (JWT)

Большинство эндпоинтов требуют JWT токен:

```
Authorization: Bearer {access_token}
```

Токен получается через `POST /api/auth/login`.

### Роботы

Эндпоинт `POST /api/metrics` использует токен робота:

```
Authorization: Bearer {robot_token}
```

Токен выдаётся после подтверждения привязки.

## Основные эндпоинты

| Группа | Эндпоинты | Описание |
|--------|-----------|----------|
| Auth | `/api/auth/*` | Вход, refresh токенов |
| Robots | `/api/robots/*` | CRUD роботов (требует JWT) |
| Pairing | `/api/pair/*` | Привязка роботов по коду |
| Metrics | `/api/metrics` | Приём метрик от агентов |
| Health | `/health` | Проверка работоспособности |

## Разграничение доступа

| Роль | Права |
|------|-------|
| `user` | Видит только своих роботов |
| `admin` | Видит всех роботов |
